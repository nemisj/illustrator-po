/**********************************************************ADOBE SYSTEMS INCORPORATED Copyright 2005-2006 Adobe Systems Incorporated All Rights Reserved NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the termsof the Adobe license agreement accompanying it.  If you have received this file from a source other than Adobe, then your use, modification,or distribution of it requires the prior written permission of Adobe. *********************************************************//** Exports currently selected layer into po and creates jpeg file for preview.*/// Main Code [Execution of script begins here](function () {        var doc = app.activeDocument;    var folder = Folder.selectDialog('Please select folder to save');    if (!folder) {        // ok, what ever         return;    }    // getting filename of the current open file    var fileName = doc.name;    // removing extension part from the end    fileName = fileName.replace(/\.[^.]+$/,'');    //    // Creating File instances    //    var potFile = new File(folder + '/' + fileName + '.pot');    var pdfFile = new File(folder + '/' + fileName);    var poFile = new File(folder + '/' + fileName + '.en' + '.po');    // build global content    var content = [];    var textRefs = doc.activeLayer.textFrames;    for (var i = 0; i < textRefs.length; i++) {        var textItem = textRefs[i];        var textContent = textItem.contents;             textContent = textContent.replace(/\n/, ' ');        textContent = textContent.replace(/\r/, ' ');                content.push('msgid "' + textContent + '"');        content.push('msgstr "' + textContent + '"');        content.push('');      }    // exporting file as jpeg for now    doc.exportFile(pdfFile, ExportType.JPEG);        // creating pot file    var success = potFile.open('w:');    potFile.encoding = 'UTF-8';    potFile.lineFeed = 'Windows';    potFile.write(content.join('\n'));    potFile.close();        //creating po file    poFile.open('w:');    poFile.encoding = 'UTF-8';    poFile.lineFeed = 'Windows';    var poContent = [];    poContent.push('msgid ""');    poContent.push('msgstr ""');    poContent.push('"Project-Id-Version: \\n"');    poContent.push('"POT-Creation-Date: \\n"');    poContent.push('"PO-Revision-Date: \\n"');    poContent.push('"Last-Translator: \\n"');    poContent.push('"Language-Team: \\n"');    poContent.push('"MIME-Version: 1.0\\n"');    poContent.push('"Content-Type: text/plain; charset=UTF-8\\n"');    poContent.push('"Content-Transfer-Encoding: 8bit\\n"');    poContent.push('"X-Generator: maks.nemisj.exporter 0.0.1\\n"');    poContent.push('');        poContent = poContent.concat(content);        poFile.write(poContent.join('\n'));    poFile.close();    $.write('DONE');})();alert( 'PO stuff exported' );